<!DOCTYPE html>

<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>
   All Tracks
  </title>
  <link href="andreas01.css" media="screen,projection" rel="stylesheet" type="text/css"/>
  <link href="print.css" media="print" rel="stylesheet" type="text/css"/>
  <style>
  
 body {
            font-family: Arial, sans-serif;
            background-image: url('');
            background-size: cover;
            background-repeat: no-repeat;
            background-position: center;
            margin: 0;
            padding: 20px;
            color: #000; /* Set default text color to black */
        }
        .track-list {
            list-style-type: none;
            padding: 0;
            display: grid; /* Use CSS Grid for layout */
            grid-template-columns: repeat(3, 1fr); /* Three columns with equal width */
            gap: 10px; /* Gap between items */
        }
        .track-list li {
            position: relative; /* Ensure the hover box is positioned relative to the item */
            margin: 0;
            line-height: 1.5; /* Set line height for single spacing */
            cursor: pointer;
            color: #000; /* Default text color */
        }
        .track-list li.selected {
            color: blue; /* Selected text color */
        }

        .styled-button {
            margin-top: 20px;
            padding: 10px 20px;
            background-color: #808080; /* Grey background */
            color: #fff; /* White text */
            border: none;
            cursor: pointer;
        }

        #footer {
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 10px;
        }
        .hover-box {
            display: none;
            position: absolute;
            background-color: #f9f9f9;
            border: 2px solid #ccc;
            padding: 10px;
            z-index: 1;
            white-space: pre-wrap;
            width: 250px;
            max-height: 80vh;
            overflow: auto;
            left: calc(100% + 10px);
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
            border-radius: 4px;
        }
        .track-list li:hover .hover-box {
            display: block;
        }

     /* Ensuring buttons are placed properly */
        #controls {
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
        }
  </style>
 </head>
 <body>

  <div id="wrap">
   <div id="header">
<p></p>  <p></p> 
    <h1>&nbsp;&nbsp;
     <a href="#">
      All Tracks
     </a>
    </h1>

 <h2><a href="Help.html">Help</a></h2>

 <img alt="" height="190" id="frontphoto" src="img/guitarplayerheader2.jpg" width="760"/>

<div class="navbar">
  
    <a href="Tracks.html">All Tracks</a>
    <a href="blues.html">Blues</a>
    <a href="childballads.html">Child Ballads</a>
    <a href="childrensongs.html">Children's Songs</a>
    <a href="christmas.html">Christmas</a>
    <a href="country.html">Country</a>
    <a href="folk.html">Folk Songs</a>
    <a href="irish.html">Irish</a>
    <a href="gospel.html">Gospel</a>
    <a href="scottish.html">Scottish</a>
    <a href="shanties.html">Shanties</a>
 
</div>

    <h1>
     Select Tracks
    </h1>
  
  <!-- Search input -->
<input id="searchInput" placeholder="Search for a song by title, author or year composed..." 
       style="width: 100%; padding: 10px; box-sizing: border-box;" type="text"/>

<small style="display: block; margin-top: 4px; margin-bottom: 1em; color: #555; font-style: italic; font-size: 0.9em;">
  You can search by title, author, or year range the song was originally composed (e.g., 1900-1920) or, below, filter by when the song was recorded here.
</small>

<div style="margin-bottom: 1em;">
  <label for="from-date">From: </label>
  <input type="date" id="from-date">
  <label for="to-date">To: </label>
  <input type="date" id="to-date">
  <button onclick="filterByDate()">Filter</button>
  <button onclick="clearDateFilter()">Clear</button>
  <button onclick="sortByDate()">Sort by Date</button>
  <select id="authorDropdown" style="min-width: 170px; max-width: 170px; height: 22px; margin-left: 8px; vertical-align: bottom; font-size: 13px;"></select>
</div>

    <!-- Select All Button -->
    <button class="styled-button" id="selectAllButton">
     Select All
    </button>
    <!-- Select Random Button -->
    <!-- Select Number Button -->
    <button class="styled-button" id="selectNumberButton">
     Select Random Songs
    </button>

    <!-- Play Button -->
    <button class="styled-button" id="finished-selecting">
     Play
    </button>

    <ul class="track-list">

    <!--Template - just add in song tracks here-->

    </ul>

    <script>
     document.addEventListener("DOMContentLoaded", function() {
    const trackListItems = document.querySelectorAll('.track-list li');
    const searchInput = document.getElementById('searchInput');
    const selectAllButton = document.getElementById("selectAllButton");
    const finishedButton = document.getElementById('finished-selecting');

    // Select All functionality
    selectAllButton.addEventListener("click", function() {
        trackListItems.forEach(item => item.classList.add('selected'));
    });

    // Finished selecting functionality (Play button)
    finishedButton.addEventListener('click', function() {
        const selectedPlaylist = [];
        trackListItems.forEach(item => {
            if (item.classList.contains('selected')) {
                const songSrc = item.getAttribute('data-src');
                const songTitle = item.getAttribute('data-title');
                const songComments = item.getAttribute('data-comments') || ''; // Retrieve comments
                selectedPlaylist.push({ src: songSrc, title: songTitle, comments: songComments });
            }
        });

        // Store selected playlist in localStorage
        localStorage.setItem('playlist', JSON.stringify(selectedPlaylist));

        // Redirect back to index.html
        window.location.href = 'index.html';
    });

    // Toggle selection of individual tracks
    trackListItems.forEach(item => {
        item.addEventListener('click', function() {
            item.classList.toggle('selected');
        });
    });
searchInput.addEventListener('input', function() {
  const filter = searchInput.value.toLowerCase().trim();
  const rangeMatch = filter.match(/(\d{4})\s*[-–]\s*(\d{4})/); // Handles "1900-1920"

  trackListItems.forEach(function(item) {
    const title = item.getAttribute('data-title')?.toLowerCase() || '';
    const author = item.getAttribute('data-author')?.toLowerCase() || '';
    const dateComposedStr = item.getAttribute('data-date-composed')?.toLowerCase() || '';
    let match = false;

    // Text search (e.g., "Irish", "Dylan", "1960s")
    if (title.includes(filter) || author.includes(filter) || dateComposedStr.includes(filter)) {
      match = true;
    }

    // If a numeric year range is entered, override the match logic
    if (rangeMatch) {
      const startYear = parseInt(rangeMatch[1]);
      const endYear = parseInt(rangeMatch[2]);

      // Only evaluate as a year if it's a strict 4-digit number
      if (/^\d{4}$/.test(dateComposedStr)) {
        const year = parseInt(dateComposedStr);
        match = (year >= startYear && year <= endYear);
      } else {
        match = false; // Exclude "1960s", "early 1900s", etc. from numeric range matches
      }
    }

    item.style.display = match ? '' : 'none';
  });
});



    
    // Hover box adjustment for overflow
    document.querySelectorAll('.track-list li').forEach(function(track) {
        track.addEventListener('mouseover', function() {
            const hoverBox = this.querySelector('.hover-box');
            const rect = hoverBox.getBoundingClientRect();
            const viewportHeight = window.innerHeight;

            // Check if hover box would go below the viewport
            if (rect.bottom > viewportHeight) {
                hoverBox.style.top = `-${rect.height}px`;
            } else {
                hoverBox.style.top = '0';
            }
        });
    });
});
    </script>
    <div id="footer">
     <p>
      Copyright © 2025
      <a href="img/PatMcD4x4.jpg">
       Thomas Patrick McDonnell
      </a>
      · 
        |
      <a href="homepage.html">
       Homepage
      </a>
     </p>
    </div>
   </div>
  </div>
  <script>
   function getAllTrackItems() {
    return Array.from(document.querySelectorAll(".track-list li"));
  }

  function clearAllSelections() {
    getAllTrackItems().forEach(item => item.classList.remove("selected"));
  }

  function selectRandomItems(count) {
    const items = getAllTrackItems();
    clearAllSelections();
    if (count > items.length) count = items.length;
    const shuffled = [...items].sort(() => 0.5 - Math.random());
    const selected = shuffled.slice(0, count);
    selected.forEach(item => item.classList.add("selected"));
  }

  document.getElementById("selectNumberButton").addEventListener("click", () => {
    const total = getAllTrackItems().length;
    const input = prompt(`Enter the number of songs to select (1 to ${total}):`, "10");
    const num = parseInt(input, 10);
    if (!isNaN(num) && num > 0 && num <= total) {
      selectRandomItems(num);
    } else {
      alert("Please enter a valid number between 1 and " + total);
    }
  });
  </script>

<script>
let sortAscending = true;

function filterByDate() {
  const fromDate = document.getElementById('from-date').value;
  const toDate = document.getElementById('to-date').value;
  const items = document.querySelectorAll('li[data-modified]');

  items.forEach(li => {
    const modDate = li.getAttribute('data-modified');
    if (
      (!fromDate || modDate >= fromDate) &&
      (!toDate || modDate <= toDate)
    ) {
      li.style.display = '';
    } else {
      li.style.display = 'none';
    }
  });
}

function clearDateFilter() {
  document.getElementById('from-date').value = '';
  document.getElementById('to-date').value = '';
  document.querySelectorAll('li[data-modified]').forEach(li => {
    li.style.display = '';
  });
}

function sortByDate() {
  const ul = document.querySelector('ul');
  const items = Array.from(document.querySelectorAll('li[data-modified]'));

  items.sort((a, b) => {
    const dateA = a.getAttribute('data-modified');
    const dateB = b.getAttribute('data-modified');
    return sortAscending ? dateA.localeCompare(dateB) : dateB.localeCompare(dateA);
  });

  items.forEach(li => ul.appendChild(li)); // Reorder in DOM
  sortAscending = !sortAscending;
}
</script>

<script>
// Fetch authors.json and populate the dropdown
fetch('authors.json')
  .then(response => response.json())
  .then(authors => {
    const dropdown = document.getElementById('authorDropdown');

    // Add placeholder option
    const defaultOption = document.createElement('option');
    defaultOption.value = '';
    defaultOption.textContent = 'Select Author...';
    dropdown.appendChild(defaultOption);

    // Add authors
    authors.forEach(author => {
      const option = document.createElement('option');
      option.value = author;
      option.textContent = author;
      dropdown.appendChild(option);
    });

    // Handle filtering on selection
    dropdown.addEventListener('change', () => {
      const selectedAuthor = dropdown.value;
      const items = document.querySelectorAll('ul.track-list li');

      items.forEach(item => {
        const itemAuthor = item.getAttribute('data-author');
        if (!selectedAuthor || selectedAuthor === itemAuthor) {
          item.style.display = '';
        } else {
          item.style.display = 'none';
        }
      });
    });
  })
  .catch(error => console.error('Error loading authors:', error));

// Create Clear Author button
const clearAuthorButton = document.createElement('button');
clearAuthorButton.textContent = 'Clear Author';
clearAuthorButton.style.marginLeft = '8px';
clearAuthorButton.style.height = '22px';
clearAuthorButton.style.fontSize = '13px';
clearAuthorButton.style.padding = '1px 6px';
clearAuthorButton.style.lineHeight = 'normal';
clearAuthorButton.style.verticalAlign = 'bottom';

document.addEventListener('DOMContentLoaded', () => {
  const controlPanel = document.querySelector('#from-date').parentElement;
  controlPanel.insertBefore(clearAuthorButton, document.getElementById('authorDropdown').nextSibling);

  clearAuthorButton.addEventListener('click', () => {
    const dropdown = document.getElementById('authorDropdown');
    dropdown.selectedIndex = 0;
    dropdown.scrollTop = 0;
    dropdown.blur();

    // Reset track visibility
    const items = document.querySelectorAll('ul.track-list li');
    items.forEach(item => item.style.display = '');
  });

  // On page load, reset dropdown to top
  const dropdown = document.getElementById('authorDropdown');
  dropdown.selectedIndex = 0;
  dropdown.scrollTop = 0;
  dropdown.style.height = '22px';

  // Reset dropdown on song click
  const songs = document.querySelectorAll('ul.track-list li');
  songs.forEach(song => {
    song.addEventListener('click', () => {
      dropdown.selectedIndex = 0;
      dropdown.scrollTop = 0;
      dropdown.blur();
    });
  });
});

// Optional: dropdown expand/collapse if you want to keep it
const dropdown = document.getElementById('authorDropdown');
dropdown.addEventListener('focus', () => {
  dropdown.style.height = 'auto';
});
dropdown.addEventListener('blur', () => {
  dropdown.style.height = '22px';
});
</script>

 </body>
</html>
